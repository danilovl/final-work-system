{% extends 'layout.html.twig' %}

{% block content %}
	<div class="right_col" role="main">
		<div class="x_content bs-example-popovers">
			 {{ homepage_notify() }}
		</div>
		<div class="">
			<div class="clearfix"></div>
			{% if  isSystemEventUnreadExist %}
				<div class="row">
					<div class="col-md-12 col-sm-12 col-xs-12 mb-small">
						{{ 'app.text.set_alerts_all_viewed' | trans }}

						{% include 'common_part/button/js-switch.html.twig' with {
							'dataTargetUrl': path('system_event_all_change_to_viewed_ajax')
						} %}
					</div>
				</div>
			{% endif %}

			<div class="row">
				{% for key,group in systemEventGroup %}
					<div class="col-md-6 col-sm-6 col-xs-12">
						<div class="x_panel tile fixed_height_320">
							<div class="x_title">
								<h2>
									{{ key }}
								</h2>
								<ul class="nav navbar-right panel_toolbox">
									<li>
										<a class="collapse-link">
											<i class="fa fa-chevron-up"></i>
										</a>
									</li>
								</ul>
								<div class="clearfix"></div>
							</div>
							<div class="x_content">
								<div class="system-event-table">

									{% set directionParam = systemEventPagination.getPaginatorOption('sortDirectionParameterName') %}
									{% set params = systemEventPagination.getParams() %}
									{% set direction = params[directionParam] is defined ? params[directionParam] : null %}

									<table class="table">
										<thead>
										<tr>
											<th style="width: 22%" {% if systemEventPagination.isSorted('system_event_recipient.createdAt') %} class="fa fa-sort-{{ direction }}"{% endif %}>
												{{ knp_pagination_sortable(systemEventPagination, 'app.text.date_added' | trans(), 'system_event_recipient.createdAt') }}
											</th>
											<th style="width: 10%"></th>
											<th>
												{{ 'app.text.event' | trans() }}
											</th>
											<th{% if systemEventPagination.isSorted('system_event_recipient.viewed') %} class="fa fa-sort-{{ direction }}"{% endif %}>
												{{ knp_pagination_sortable(systemEventPagination, 'app.text.state' | trans(), 'system_event_recipient.viewed') }}
											</th>
										</thead>
										<tbody>

										{% for systemEventRecipient in group %}
											<tr class="active">
												<td>
													{{ systemEventRecipient.createdAt | date("d.m.Y H:i") }}
												</td>
												<td>
													<ul class="list-inline">
														<li>
															<img src="{{ systemEventRecipient.systemEvent.owner | profile_image }}"
																 class="avatar" alt="Avatar">
														</li>
													</ul>
												</td>
												<td>
													{{ system_event_generate_link(systemEventRecipient) | raw }}
												</td>
												<td>
													{% include 'common_part/button/js-switch.html.twig' with {
														'checked': systemEventRecipient.viewed,
														'dataTargetUrl': path('system_event_change_viewed_ajax',{'id': systemEventRecipient.id | hashids_encode })
													} %}
												</td>
											</tr>
										{% endfor %}

										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				{% endfor %}

			</div>
			<div class="navigation">
				{{ knp_pagination_render(systemEventGroup) }}
			</div>
		</div>
	</div>
{% endblock %}